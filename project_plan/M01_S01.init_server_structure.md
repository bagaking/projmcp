---
milestone: M01
sprint: S01  
created_date: 2025-01-24
description: 初始化MCP服务器基础结构的详细执行计划
purpose: 建立项目基础框架，配置开发环境，实现MCP服务器启动逻辑
---

# M01_S01: 初始化服务器基础结构

## OKR

### Objective
建立完整的MCP服务器项目基础，确保开发环境配置正确，服务器可以正常启动并响应基础连接。

### Key Results
1. **KR1**: Node.js项目结构完整初始化，包含package.json、tsconfig.json等配置文件
2. **KR2**: TypeScript编译和代码规范检查通过，零错误零警告
3. **KR3**: MCP服务器可通过npm命令启动，并正常监听stdio传输
4. **KR4**: 基础的健康检查和错误处理机制就位

## 执行检查清单

### 阶段1: 项目环境初始化
- [ ] 创建package.json，配置项目基础信息
  - [ ] 设置项目名称为"mcp-project-plan-server"  
  - [ ] 配置版本为"1.0.0"
  - [ ] 添加main入口指向dist/index.js
  - [ ] 配置npm scripts (build, dev, start, test, lint)
- [ ] 安装核心依赖
  - [ ] @modelcontextprotocol/sdk (MCP官方SDK)
  - [ ] zod (参数验证)
- [ ] 安装开发依赖  
  - [ ] typescript (TypeScript编译器)
  - [ ] @types/node (Node.js类型定义)
  - [ ] tsx (TypeScript执行器)
  - [ ] eslint相关包 (代码规范)

### 阶段2: TypeScript配置
- [ ] 创建tsconfig.json配置
  - [ ] 启用strict模式
  - [ ] 配置ESM模块系统
  - [ ] 设置编译输出到dist目录
  - [ ] 包含src目录，排除node_modules等
- [ ] 创建.eslintrc.js配置
  - [ ] 使用MCP SDK推荐的ESLint规则
  - [ ] 配置TypeScript解析器
  - [ ] 设置代码风格规则 (2空格缩进，单引号等)

### 阶段3: 项目结构创建
- [ ] 创建src目录结构
  - [ ] src/index.ts (服务器入口文件)
  - [ ] src/server.ts (MCP服务器核心逻辑)
  - [ ] src/tools/ (工具实现目录)
  - [ ] src/utils/ (工具类目录)
  - [ ] src/templates/ (模板文件目录)
- [ ] 创建基础文件
  - [ ] README.md (项目说明文档)
  - [ ] .gitignore (Git忽略规则)
  - [ ] .npmignore (npm发布忽略规则)

### 阶段4: MCP服务器基础实现
- [ ] 实现src/index.ts
  - [ ] 导入MCP SDK相关模块
  - [ ] 创建McpServer实例
  - [ ] 配置StdioServerTransport
  - [ ] 添加基础错误处理和日志
- [ ] 实现src/server.ts
  - [ ] 定义服务器基础配置
  - [ ] 实现服务器初始化逻辑
  - [ ] 添加健康检查机制
  - [ ] 实现优雅关闭处理

### 阶段5: 构建和测试
- [ ] 验证TypeScript编译
  - [ ] npm run build 无错误
  - [ ] 生成的dist文件结构正确
- [ ] 验证代码规范
  - [ ] npm run lint 零警告
  - [ ] 代码格式符合配置要求
- [ ] 验证服务器启动
  - [ ] npm run start 成功启动服务器
  - [ ] 服务器正常监听stdio
  - [ ] 可以接收基础MCP协议消息

## 关键知识

### MCP协议基础知识
MCP (Model Context Protocol) 是一个标准化协议，用于AI模型与外部数据源和工具的交互。核心概念：

1. **Server/Client架构**: 服务器提供工具和资源，客户端(如Claude)调用这些功能
2. **Transport层**: 支持stdio、HTTP等传输方式，我们使用stdio适配命令行环境
3. **工具注册**: 通过registerTool注册自定义工具供客户端调用
4. **类型安全**: 使用zod进行参数验证，确保类型安全

### TypeScript项目最佳实践
参考来源: MCP SDK官方文档和代码规范

1. **严格模式**: 启用所有TypeScript严格检查选项
2. **模块系统**: 使用ES模块，文件扩展名包含.js（编译后）
3. **目录组织**: 源码在src，构建产物在dist，测试就近放置
4. **命名规范**: camelCase变量/函数，PascalCase类/类型，kebab-case文件名

### NPM项目配置要点  
1. **入口配置**: main指向编译后的文件，支持ES模块和CommonJS
2. **脚本配置**: build、dev、start、test、lint等常用脚本
3. **依赖管理**: 区分dependencies和devDependencies
4. **版本策略**: 遵循语义版本控制

## 验收标准

### 功能验收
1. ✅ **环境验收**: `npm install` 无错误完成
2. ✅ **编译验收**: `npm run build` 成功生成dist目录
3. ✅ **规范验收**: `npm run lint` 零警告通过
4. ✅ **启动验收**: `npm run start` 成功启动MCP服务器
5. ✅ **连接验收**: 服务器可正常接收MCP初始化消息

### 代码质量验收
1. ✅ TypeScript strict模式无编译错误
2. ✅ ESLint规则检查全部通过  
3. ✅ 代码注释覆盖率≥80%（公共API必须有JSDoc）
4. ✅ 错误处理机制完整，包含日志和异常捕获

### 项目结构验收
```
├── package.json          # 项目配置
├── tsconfig.json         # TS编译配置  
├── .eslintrc.js          # 代码规范配置
├── README.md             # 项目文档
├── src/
│   ├── index.ts          # 入口文件
│   ├── server.ts         # 服务器核心
│   ├── tools/            # 工具目录(空)
│   ├── utils/            # 工具类目录(空)
│   └── templates/        # 模板目录(空)  
└── dist/                 # 编译产物
    └── index.js
```

### 集成验收
通过Claude Code测试MCP服务器：
1. 在项目目录运行 `npm run start`
2. Claude可以成功连接到MCP服务器
3. 服务器响应基础的list_tools等MCP协议消息
4. 无异常退出，日志信息正常

## 风险和依赖
1. **技术风险**: MCP SDK版本兼容性，需确保使用稳定版本
2. **环境依赖**: Node.js版本≥18，npm版本≥8
3. **外部依赖**: 依赖网络安装npm包，需确保网络连通性

## 预期工作量
- **开发时间**: 4-6小时
- **测试时间**: 2小时  
- **文档时间**: 1小时
- **总计**: 1个工作日内完成